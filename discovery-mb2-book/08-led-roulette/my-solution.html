<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>My solution - Discovery</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="Discover the world of microcontrollers through Rust with the BB2 micro:bit v2">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.html">Introduction</a></li><li class="chapter-item expanded "><a href="../01-background/index.html"><strong aria-hidden="true">1.</strong> Background</a></li><li class="chapter-item expanded "><a href="../02-requirements/index.html"><strong aria-hidden="true">2.</strong> Hardware/knowledge requirements</a></li><li class="chapter-item expanded "><a href="../03-setup/index.html"><strong aria-hidden="true">3.</strong> Setting up a development environment</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../03-setup/linux.html"><strong aria-hidden="true">3.1.</strong> Linux</a></li><li class="chapter-item expanded "><a href="../03-setup/windows.html"><strong aria-hidden="true">3.2.</strong> Windows</a></li><li class="chapter-item expanded "><a href="../03-setup/macos.html"><strong aria-hidden="true">3.3.</strong> macOS</a></li><li class="chapter-item expanded "><a href="../03-setup/verify.html"><strong aria-hidden="true">3.4.</strong> Verify the installation</a></li><li class="chapter-item expanded "><a href="../03-setup/IDE.html"><strong aria-hidden="true">3.5.</strong> Setting up your IDE</a></li></ol></li><li class="chapter-item expanded "><a href="../04-meet-your-hardware/index.html"><strong aria-hidden="true">4.</strong> Meet your hardware</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../04-meet-your-hardware/microbit-v2.html"><strong aria-hidden="true">4.1.</strong> micro:bit v2</a></li><li class="chapter-item expanded "><a href="../04-meet-your-hardware/terminology.html"><strong aria-hidden="true">4.2.</strong> Rust Embedded terminology</a></li></ol></li><li class="chapter-item expanded "><a href="../05-meet-your-software/index.html"><strong aria-hidden="true">5.</strong> Meet your software</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../05-meet-your-software/build-it.html"><strong aria-hidden="true">5.1.</strong> Build it</a></li><li class="chapter-item expanded "><a href="../05-meet-your-software/flash-it.html"><strong aria-hidden="true">5.2.</strong> Flash it</a></li><li class="chapter-item expanded "><a href="../05-meet-your-software/debug-it.html"><strong aria-hidden="true">5.3.</strong> Debug it</a></li><li class="chapter-item expanded "><a href="../05-meet-your-software/light-it-up.html"><strong aria-hidden="true">5.4.</strong> Light it up</a></li></ol></li><li class="chapter-item expanded "><a href="../06-hello-world/index.html"><strong aria-hidden="true">6.</strong> Hello World</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../06-hello-world/toggle-it.html"><strong aria-hidden="true">6.1.</strong> Toggle it</a></li><li class="chapter-item expanded "><a href="../06-hello-world/spin-wait.html"><strong aria-hidden="true">6.2.</strong> Spin wait</a></li><li class="chapter-item expanded "><a href="../06-hello-world/nop.html"><strong aria-hidden="true">6.3.</strong> NOP</a></li><li class="chapter-item expanded "><a href="../06-hello-world/timers.html"><strong aria-hidden="true">6.4.</strong> Timers</a></li><li class="chapter-item expanded "><a href="../06-hello-world/portability.html"><strong aria-hidden="true">6.5.</strong> Portability</a></li><li class="chapter-item expanded "><a href="../06-hello-world/board-support-crate.html"><strong aria-hidden="true">6.6.</strong> Board support crate</a></li></ol></li><li class="chapter-item expanded "><a href="../07-registers/index.html"><strong aria-hidden="true">7.</strong> Registers</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../07-registers/rtrm.html"><strong aria-hidden="true">7.1.</strong> RTRM</a></li><li class="chapter-item expanded "><a href="../07-registers/misoptimization.html"><strong aria-hidden="true">7.2.</strong> (mis)Optimization</a></li><li class="chapter-item expanded "><a href="../07-registers/bad-address.html"><strong aria-hidden="true">7.3.</strong> 0xBAAAAAAD address</a></li><li class="chapter-item expanded "><a href="../07-registers/spooky-action-at-a-distance.html"><strong aria-hidden="true">7.4.</strong> Spooky action at a distance</a></li><li class="chapter-item expanded "><a href="../07-registers/type-safe-manipulation.html"><strong aria-hidden="true">7.5.</strong> Type safe manipulation</a></li></ol></li><li class="chapter-item expanded "><a href="../08-led-roulette/index.html"><strong aria-hidden="true">8.</strong> LED roulette</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../08-led-roulette/the-challenge.html"><strong aria-hidden="true">8.1.</strong> The challenge</a></li><li class="chapter-item expanded "><a href="../08-led-roulette/my-solution.html" class="active"><strong aria-hidden="true">8.2.</strong> My solution</a></li></ol></li><li class="chapter-item expanded "><a href="../09-serial-communication/index.html"><strong aria-hidden="true">9.</strong> Serial communication</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../09-serial-communication/nix-tooling.html"><strong aria-hidden="true">9.1.</strong> *nix tooling</a></li><li class="chapter-item expanded "><a href="../09-serial-communication/windows-tooling.html"><strong aria-hidden="true">9.2.</strong> Windows tooling</a></li></ol></li><li class="chapter-item expanded "><a href="../10-uart/index.html"><strong aria-hidden="true">10.</strong> UART</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../10-uart/send-a-single-byte.html"><strong aria-hidden="true">10.1.</strong> Send a single byte</a></li><li class="chapter-item expanded "><a href="../10-uart/send-a-string.html"><strong aria-hidden="true">10.2.</strong> Send a string</a></li><li class="chapter-item expanded "><a href="../10-uart/naive-approach-write.html"><strong aria-hidden="true">10.3.</strong> Naive approach and write!</a></li><li class="chapter-item expanded "><a href="../10-uart/receive-a-single-byte.html"><strong aria-hidden="true">10.4.</strong> Receive a single byte</a></li><li class="chapter-item expanded "><a href="../10-uart/echo-server.html"><strong aria-hidden="true">10.5.</strong> Echo server</a></li><li class="chapter-item expanded "><a href="../10-uart/reverse-a-string.html"><strong aria-hidden="true">10.6.</strong> Reverse a string</a></li><li class="chapter-item expanded "><a href="../10-uart/my-solution.html"><strong aria-hidden="true">10.7.</strong> My solution</a></li></ol></li><li class="chapter-item expanded "><a href="../11-i2c/index.html"><strong aria-hidden="true">11.</strong> I2C</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../11-i2c/the-general-protocol.html"><strong aria-hidden="true">11.1.</strong> The general protocol</a></li><li class="chapter-item expanded "><a href="../11-i2c/lsm303agr.html"><strong aria-hidden="true">11.2.</strong> LSM303AGR</a></li><li class="chapter-item expanded "><a href="../11-i2c/read-a-single-register.html"><strong aria-hidden="true">11.3.</strong> Read a single register</a></li><li class="chapter-item expanded "><a href="../11-i2c/using-a-driver.html"><strong aria-hidden="true">11.4.</strong> Using a driver</a></li><li class="chapter-item expanded "><a href="../11-i2c/the-challenge.html"><strong aria-hidden="true">11.5.</strong> The challenge</a></li><li class="chapter-item expanded "><a href="../11-i2c/my-solution.html"><strong aria-hidden="true">11.6.</strong> My solution</a></li></ol></li><li class="chapter-item expanded "><a href="../12-led-compass/index.html"><strong aria-hidden="true">12.</strong> LED compass</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../12-led-compass/magnitude.html"><strong aria-hidden="true">12.1.</strong> Magnitude</a></li><li class="chapter-item expanded "><a href="../12-led-compass/the-challenge.html"><strong aria-hidden="true">12.2.</strong> The challenge</a></li><li class="chapter-item expanded "><a href="../12-led-compass/my-solution.html"><strong aria-hidden="true">12.3.</strong> My solution</a></li></ol></li><li class="chapter-item expanded "><a href="../13-punch-o-meter/index.html"><strong aria-hidden="true">13.</strong> Punch-o-meter</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../13-punch-o-meter/gravity-is-up.html"><strong aria-hidden="true">13.1.</strong> Gravity is up?</a></li><li class="chapter-item expanded "><a href="../13-punch-o-meter/the-challenge.html"><strong aria-hidden="true">13.2.</strong> The challenge</a></li><li class="chapter-item expanded "><a href="../13-punch-o-meter/my-solution.html"><strong aria-hidden="true">13.3.</strong> My solution</a></li></ol></li><li class="chapter-item expanded "><a href="../14-snake-game/index.html"><strong aria-hidden="true">14.</strong> Snake game</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../14-snake-game/game-logic.html"><strong aria-hidden="true">14.1.</strong> Game logic</a></li><li class="chapter-item expanded "><a href="../14-snake-game/controls.html"><strong aria-hidden="true">14.2.</strong> Controls</a></li><li class="chapter-item expanded "><a href="../14-snake-game/nonblocking-display.html"><strong aria-hidden="true">14.3.</strong> Non-blocking display</a></li><li class="chapter-item expanded "><a href="../14-snake-game/final-assembly.html"><strong aria-hidden="true">14.4.</strong> Final assembly</a></li></ol></li><li class="chapter-item expanded "><a href="../explore.html"><strong aria-hidden="true">15.</strong> What's left for you to explore</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><a href="../appendix/1-general-troubleshooting/index.html">General troubleshooting</a></li><li class="chapter-item expanded affix "><a href="../appendix/2-how-to-use-gdb/index.html">How to use GDB</a></li><li class="chapter-item expanded affix "><a href="../appendix/3-mag-calibration/index.html">Magnetometer Calibration</a></li><li class="spacer"></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Discovery</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/rust-embedded/discovery-mb2/" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="my-solution"><a class="header" href="#my-solution">My solution</a></h1>
<p>What solution did you come up with?</p>
<p>Here's mine. It's probably one of the simplest (but of course not most beautiful) ways to generate
the required matrix:</p>
<pre><pre class="playground"><code class="language-rust">#![deny(unsafe_code)]
#![no_main]
#![no_std]

use cortex_m_rt::entry;
use microbit::{board::Board, display::blocking::Display, hal::Timer};
use panic_rtt_target as _;
use rtt_target::rtt_init_print;

#[rustfmt::skip]
const PIXELS: [(usize, usize); 16] = [
    (0, 0),
    (0, 1),
    (0, 2),
    (0, 3),
    (0, 4),
    (1, 4),
    (2, 4),
    (3, 4),
    (4, 4),
    (4, 3),
    (4, 2),
    (4, 1),
    (4, 0),
    (3, 0),
    (2, 0),
    (1, 0),
];

#[entry]
fn main() -&gt; ! {
    rtt_init_print!();

    let board = Board::take().unwrap();
    let mut timer = Timer::new(board.TIMER0);
    let mut display = Display::new(board.display_pins);
    #[rustfmt::skip]
    let mut leds = [
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0],
    ];

    let mut last_led = (0, 0);

    loop {
        for current_led in PIXELS.iter() {
            leds[last_led.0][last_led.1] = 0;
            leds[current_led.0][current_led.1] = 1;
            display.show(&amp;mut timer, leds, 30);
            last_led = *current_led;
        }
    }
}</code></pre></pre>
<p>One more thing! Check that your solution also works when compiled in &quot;release&quot; mode:</p>
<pre><code class="language-console">$ cargo embed --release
</code></pre>
<p>If you want to debug your &quot;release&quot; mode binary you'll have to use a different GDB command:</p>
<pre><code class="language-console">$ gdb ../../../target/thumbv7em-none-eabihf/release/led-roulette
</code></pre>
<p>The Rust compiler modifies the machine instructions generated in a release build (sometimes by a
lot) in order to try to make the code faster or smaller. Unfortunately, GDB has a hard time figuring
out what is going on after this. As a result, debugging release builds with GDB can be difficult.</p>
<p>Binary size is something we should always keep an eye on! How big is your solution? You can check
that using the <code>size</code> command on the release binary:</p>
<pre><code class="language-console">$ cargo size --release -- -A
    Finished release [optimized + debuginfo] target(s) in 0.02s
led-roulette  :
section              size        addr
.vector_table         256         0x0
.text                6332       0x100
.rodata               648      0x19bc
.data                   0  0x20000000
.bss                 1076  0x20000000
.uninit                 0  0x20000434
.debug_loc           9036         0x0
.debug_abbrev        2754         0x0
.debug_info         96460         0x0
.debug_aranges       1120         0x0
.debug_ranges       11520         0x0
.debug_str          71325         0x0
.debug_pubnames     32316         0x0
.debug_pubtypes     29294         0x0
.ARM.attributes        58         0x0
.debug_frame         2108         0x0
.debug_line         19303         0x0
.comment              109         0x0
Total              283715
</code></pre>
<p>Your numbers may differ somewhat depending on how your code is built: this is OK.</p>
<p>Know how to read this output? The <code>text</code> section contains the program instructions. The <code>rodata</code>
section contains read-only data stored with the program instructions. The <code>data</code> and <code>bss</code> sections
contain variables statically allocated in RAM (<code>static</code> variables).  If you remember the
specification of the microcontroller on your micro:bit, you should notice that its flash memory is
less than double the size of this extremely simple binary: can this be right?  As we can see from
the size statistics most of the binary is actually made up of debugging related sections. However,
those are not flashed to the microcontroller at any time — after all they aren't relevant for the
execution.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../08-led-roulette/the-challenge.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../09-serial-communication/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../08-led-roulette/the-challenge.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../09-serial-communication/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
